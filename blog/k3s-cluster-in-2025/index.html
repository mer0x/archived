<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="false"><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
   
  <title>How to Set Up a K3S Cluster in 2025 &middot; Merox</title>
  <meta name="title" content="How to Set Up a K3S Cluster in 2025 &middot; Merox" />
  
  <meta name="description" content="Discover how I rebuilt my K3s cluster using Ansible, optimized my Kubernetes setup, and automated deployments for a more efficient and scalable homelab." />
  <meta name="keywords" content="kubernetes, self-hosting, automation, " />
  
  
  <link rel="canonical" href="https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/" />
  
  
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/archived/css/main.bundle.min.68dadd1aae43a4e64e5bb4f6c7bf1cbb42c83a238e4424d368b7262c177c74e93176ec80d596ada510363e9b73d0acaf513d612369eecbe1e05747d1ee756984.css"
    integrity="sha512-aNrdGq5DpOZOW7T2x78cu0LIOiOORCTTaLcmLBd8dOkxduyA1ZatpRA2Pptz0KyvUT1hI2nuy&#43;HgV0fR7nVphA==" />
  
  
  <script type="text/javascript" src="/archived/js/appearance.min.2a73c1df8d14d3c8cb44d3730836295b5604b8b9d4b31ae12104ea0013e5354dc853f87592bf191dcddc55bd9062e980aa515c9d299a8f188792389bc9f2ea46.js"
    integrity="sha512-KnPB340U08jLRNNzCDYpW1YEuLnUsxrhIQTqABPlNU3IU/h1kr8ZHc3cVb2QYumAqlFcnSmajxiHkjibyfLqRg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/archived/js/main.bundle.min.3ad74b33440334ca29f8801ec6dac1f314951cf580e503d49631816b48d1f28d03543275f92b651565b48045b90731f47595b1396214b8b6aa11c6990f867f7e.js"
    integrity="sha512-OtdLM0QDNMop&#43;IAextrB8xSVHPWA5QPUljGBa0jR8o0DVDJ1&#43;StlFWW0gEW5BzH0dZWxOWIUuLaqEcaZD4Z/fg==" data-copy="Copy" data-copied="Copied"></script>
  
  
  
  <script src="/archived/lib/zoom/zoom.min.f592a181a15d2a5b042daa7f746c3721acf9063f8b6acd175d989129865a37d400ae0e85b640f9ad42cd98d1f8ad30931718cf8811abdcc5fcb264400d1a2b0c.js" integrity="sha512-9ZKhgaFdKlsELap/dGw3Iaz5Bj&#43;Las0XXZiRKYZaN9QArg6FtkD5rULNmNH4rTCTFxjPiBGr3MX8smRADRorDA=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/archived/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/archived/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/archived/favicon-16x16.png" />
  <link rel="manifest" href="/archived/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/">
  <meta property="og:title" content="How to Set Up a K3S Cluster in 2025">
  <meta property="og:description" content="Follow my step-by-step journey as I rebuild my K3s cluster from scratch using Ansible. Learn how to automate deployments, optimize performance, and create a scalable Kubernetes homelab.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2025-02-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-02-24T13:54:55+02:00">
    <meta property="article:tag" content="Kubernetes">
    <meta property="article:tag" content="Self-Hosting">
    <meta property="article:tag" content="Automation">
    <meta property="og:image" content="https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/featured-k3s.webp">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/featured-k3s.webp">
  <meta name="twitter:title" content="How to Set Up a K3S Cluster in 2025">
  <meta name="twitter:description" content="Follow my step-by-step journey as I rebuild my K3s cluster from scratch using Ansible. Learn how to automate deployments, optimize performance, and create a scalable Kubernetes homelab.">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Blog",
    "name": "How to Set Up a K3S Cluster in 2025",
    "headline": "How to Set Up a K3S Cluster in 2025",
    "description": "Follow my step-by-step journey as I rebuild my K3s cluster from scratch using Ansible. Learn how to automate deployments, optimize performance, and create a scalable Kubernetes homelab.",
    "abstract": "Discover how I rebuilt my K3s cluster using Ansible, optimized my Kubernetes setup, and automated deployments for a more efficient and scalable homelab.",
    "inLanguage": "en",
    "url" : "https:\/\/mer0x.github.io\/archived\/blog\/k3s-cluster-in-2025\/",
    "author" : {
      "@type": "Person",
      "name": "Robert Melcher"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-02-11T00:00:00\u002b00:00",
    "datePublished": "2025-02-11T00:00:00\u002b00:00",
    
    "dateModified": "2025-02-24T13:54:55\u002b02:00",
    
    "keywords": ["kubernetes","self-hosting","automation"],
    
    "mainEntityOfPage": "true",
    "wordCount": "3031"
  }]
  </script>


  
  
  <meta name="author" content="Robert Melcher" />
  
  
  
  
  <link href="https://www.facebook.com/robertmelcher97" rel="me" />
  
  
  
  
  <link href="https://www.linkedin.com/in/robert-melcher-92a1a9157" rel="me" />
  
  
  
  
  <link href="https://bsky.app/profile/meroxdev.bsky.social" rel="me" />
  
  
  
  
  <link href="https://www.reddit.com/u/merox57/s/9OgwH5Q6Rq" rel="me" />
  
  
  
  
  <link href="https://github.com/mer0x" rel="me" />
  
  
  
  
  
  
  
  
  

<script src="/archived/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  

<script async src="https://www.googletagmanager.com/gtag/js?id=G-RXSCNFY5WZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RXSCNFY5WZ');
</script>



  
  
  <style>
     
    body {
      padding-top: 48px;
    }
  
    @media (max-width: 767px) {
      body {
        padding-top: 60px;
      }
    }
  
     
    .announcement-bar {
      background-color: #0f172a;
      color: #e2e8f0;
      text-align: center;
      padding: 8px 16px;
      width: 100%;
      font-weight: 400;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 9999;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      font-size: 0.9rem;
      display: flex;
      justify-content: center;
      align-items: center;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      line-height: 1.4;
      max-height: 72px;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }
  
    @media (max-width: 767px) {
      .announcement-bar {
        font-size: 0.8rem;
        padding: 10px 12px;
        max-height: none;
        white-space: normal;
        flex-direction: column;
        line-height: 1.5;
        text-align: center;
      }
    }
  
    .announcement-bar strong {
      color: #60a5fa;
      font-weight: 600;
      margin: 0 0.2em;
    }
  
     
    a[href="#main-content"] {
      position: absolute;
      left: -9999px;
      top: auto;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }
  
    a[href="#main-content"]:focus {
      position: absolute;
      left: 0;
      top: 0;
      padding: 8px 16px;
      background-color: #e2e8f0;
      color: #1e293b;
      z-index: 10000;
      border-radius: 0 0 8px 8px;
      font-weight: 500;
    }
  </style>
  
  <meta name="theme-color"/>
  
  
  
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script>

    const firebaseConfig = {
      apiKey: "AIzaSyBtiwXkj5UkNYKd_A_sW_Rcwq5h6MLCIGo",
      authDomain: "AIzaSyBtiwXkj5UkNYKd_A_sW_Rcwq5h6MLCIGo",
      projectId: "meroxdotdev",
      storageBucket: "meroxdotdev.appspot.com",
      messagingSenderId: "117342960526",
      appId: "1:117342960526:web:310864c5484421214702df",
      measurementId: "G-P7HWH6EYM3"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
  
  
</head><body

  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  
<div class="announcement-bar">
  Permanent archive & fallback for <strong>merox.dev</strong>
</div>

  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3">
    
    
    
    <div>
        <a href="/archived/" class="flex">
            <span class="sr-only"></span>

            
            <img src="/archived/logo-simple.png" width="1326" height="532"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/archived/" class="text-base font-medium text-gray-500 hover:text-gray-900"></a>
            

        </nav>
        <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">

            
            
            
  <a href="/archived/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Who&#39;s Merox?">
        About
    </p>
</a>



            
            
  <a href="/archived/blog/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="Blog">
        Blog
    </p>
</a>



            
             
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a  class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="">
      Portfolio
    </a>
    <span>
      

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
        <a href="/archived/resume/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="Resume">
            Resume
          </p>
        </a>
        
        <a href="/archived/websites/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="Websites Portofolio">
            Websites
          </p>
        </a>
        
      </div>
    </div>
  </div>
</div>



            
             
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a  class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title="">
      Resources
    </a>
    <span>
      

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
        <a href="https://tools.merox.dev" 
          target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            IT-Tools
          </p>
        </a>
        
        <a href="https://status.merox.dev" 
          target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
          
          <p class="text-sm font-sm" title="">
            Status
          </p>
        </a>
        
      </div>
    </div>
  </div>
</div>



            
            
  <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        
    </p>
</a>



            
            
  <a href="https://merox.dev/index.xml"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <span >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM128 416c0 35.3-28.7 64-64 64s-64-28.7-64-64s28.7-64 64-64s64 28.7 64 64zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg>
  </span>


    </span>
    
    <p class="text-base font-medium" title="">
        
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class=" flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/archived/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Who&#39;s Merox?">
            About
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/archived/blog/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="Blog">
            Blog
        </p>
    </a>
</li>




                    

                     
  <li class="mt-1">
    <a href="" class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Portfolio
        </p>
        <span>
            

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


        </span>
    </a>
</li>

<li class="mt-1">
    <a href="/archived/resume/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="Resume">
            Resume
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="/archived/websites/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="Websites Portofolio">
            Websites
        </p>
    </a>
</li>

<li class="mb-2"></li>




                    

                     
  <li class="mt-1">
    <a href="" class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Resources
        </p>
        <span>
            

  <span class="relative block icon">
    <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>

  </span>


        </span>
    </a>
</li>

<li class="mt-1">
    <a href="https://tools.merox.dev"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            IT-Tools
        </p>
    </a>
</li>

<li class="mt-1">
    <a href="https://status.merox.dev"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-sm font-small" title="">
            Status
        </p>
    </a>
</li>

<li class="mb-2"></li>




                    

                    
  <li class="mt-1">
    <a href=""  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="https://merox.dev/index.xml"  target="_blank"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <div >
            

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM128 416c0 35.3-28.7 64-64 64s-64-28.7-64-64s28.7-64 64-64s64 28.7 64 64zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg>
  </span>


        </div>
        
        <p class="text-bg font-bg" title="">
            
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/archived/"
      >Merox.dev - IT Blog &amp; Documentation</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/archived/blog/"
      >Blog</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/archived/blog/k3s-cluster-in-2025/"
      >How to Set Up a K3S Cluster in 2025</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      How to Set Up a K3S Cluster in 2025
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  







  











  



<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2025-02-11T00:00:00&#43;00:00">11 February 2025</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">15 mins</span><span class="px-2 text-primary-500">&middot;</span>


<script type="text/javascript" src="/archived/js/zen-mode.min.eea5245cf9244ecbdf2c150d1c8833226c1541cadf6e98f63a7c9192b1a3676df2c3ec603b14f4cfaaa53971fd9d8955640c0f405bf3de2b43ee7a5fb29ae721.js" integrity="sha512-7qUkXPkkTsvfLBUNHIgzImwVQcrfbpj2OnyRkrGjZ23yw&#43;xgOxT0z6qlOXH9nYlVZAwPQFvz3itD7npfsprnIQ=="></script>

<span class="mb-[2px]">
    <span id="zen-mode-button"
          class="text-lg hover:text-primary-500"
          title="Enable zen mode"
          data-title-i18n-disable="Enable zen mode"
          data-title-i18n-enable="Disable zen mode">
        <span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="50px" height="50px">
    <path fill="currentColor" d="M 12.980469 4 C 9.1204688 4 5.9804688 7.14 5.9804688 11 L 6 26 L 9.9804688 26 L 9.9804688 11 C 9.9804688 9.35 11.320469 8 12.980469 8 L 40.019531 8 C 41.679531 8 43.019531 9.35 43.019531 11 L 43.019531 39 C 43.019531 40.65 41.679531 42 40.019531 42 L 29 42 C 29 43.54 28.420938 44.94 27.460938 46 L 40.019531 46 C 43.879531 46 47.019531 42.86 47.019531 39 L 47.019531 11 C 47.019531 7.14 43.879531 4 40.019531 4 L 12.980469 4 z M 7 28 C 4.794 28 3 29.794 3 32 L 3 42 C 3 44.206 4.794 46 7 46 L 23 46 C 25.206 46 27 44.206 27 42 L 27 32 C 27 29.794 25.206 28 23 28 L 7 28 z M 7 32 L 23 32 L 23.001953 42 L 7 42 L 7 32 z"/>
</svg>
  </span>

</span>
    </span>
</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/categories/devops/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    DevOps
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/categories/cloud--self-hosting/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cloud &amp; Self-Hosting
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/kubernetes/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/self-hosting/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Self-Hosting
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/automation/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Automation
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
      alt="Robert Melcher" src="/archived/merox-in-dc-2_hu_9ee03be19ccc219.webp" />
    
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Robert Melcher
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">„Sutor, ne ultra crepidam”</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.facebook.com/robertmelcher97"
          target="_blank"
          aria-label="Facebook"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.linkedin.com/in/robert-melcher-92a1a9157"
          target="_blank"
          aria-label="Linkedin"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://bsky.app/profile/meroxdev.bsky.social"
          target="_blank"
          aria-label="Bluesky"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256,232.562c-21.183,-41.196 -78.868,-117.97 -132.503,-155.834c-51.378,-36.272 -70.978,-29.987 -83.828,-24.181c-14.872,6.72 -17.577,29.554 -17.577,42.988c0,13.433 7.365,110.138 12.169,126.281c15.873,53.336 72.376,71.358 124.413,65.574c2.66,-0.395 5.357,-0.759 8.089,-1.097c-2.68,0.429 -5.379,0.796 -8.089,1.097c-76.259,11.294 -143.984,39.085 -55.158,137.972c97.708,101.165 133.908,-21.692 152.484,-83.983c18.576,62.291 39.972,180.718 150.734,83.983c83.174,-83.983 22.851,-126.674 -53.408,-137.969c-2.71,-0.302 -5.409,-0.667 -8.089,-1.096c2.732,0.337 5.429,0.702 8.089,1.096c52.037,5.785 108.54,-12.239 124.413,-65.574c4.804,-16.142 12.169,-112.847 12.169,-126.281c-0,-13.434 -2.705,-36.267 -17.577,-42.988c-12.85,-5.806 -32.45,-12.09 -83.829,24.181c-53.634,37.864 -111.319,114.635 -132.502,155.831Z"/></svg>
  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://www.reddit.com/u/merox57/s/9OgwH5Q6Rq"
          target="_blank"
          aria-label="Reddit"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/mer0x"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="mailto:hello@merox.dev"
          target="_blank"
          aria-label="Email"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</span></a
        >
      
    
  </div>

</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#what-i-want-to-achieve">What I Want to Achieve</a></li>
    <li><a href="#how-i-will-deploy">How I Will Deploy</a></li>
    <li><a href="#lets-begin">Let’s Begin!</a></li>
    <li><a href="#chapter-1-preparing-dns-and-ip-addresses">Chapter 1: Preparing DNS and IP Addresses</a>
      <ul>
        <li><a href="#dhcp-configuration">DHCP Configuration</a></li>
        <li><a href="#my-approach">My Approach</a></li>
        <li><a href="#dns-setup">DNS Setup</a></li>
      </ul>
    </li>
    <li><a href="#chapter-2-automated-vm-deployment-on-proxmox-with-cloud-init">Chapter 2: Automated VM Deployment on Proxmox with Cloud-Init</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#script-overview">Script Overview</a></li>
        <li><a href="#the-bash-script">The Bash Script</a></li>
        <li><a href="#verifying-your-deployment">Verifying Your Deployment</a></li>
      </ul>
    </li>
    <li><a href="#chapter-3-installing-k3s-with-ansible">Chapter 3: Installing K3s with Ansible</a>
      <ul>
        <li><a href="#prerequisites-1">Prerequisites</a></li>
        <li><a href="#pre-deployment-configuration">Pre-Deployment Configuration</a>
          <ul>
            <li><a href="#ansible_user">ansible_user:</a></li>
            <li><a href="#system_timezone">system_timezone:</a></li>
            <li><a href="#networking-calico-vs-flannel">Networking (<code>Calico</code> vs. <code>Flannel</code>):</a></li>
            <li><a href="#apiserver_endpoint">apiserver_endpoint:</a></li>
            <li><a href="#k3s_token">k3s_token:</a></li>
            <li><a href="#metal_lb_ip_range">metal_lb_ip_range:</a></li>
          </ul>
        </li>
        <li><a href="#deploy-the-cluster">Deploy the Cluster</a></li>
      </ul>
    </li>
    <li><a href="#whats-next">What’s Next?</a></li>
    <li><a href="#chapter-4-k3s-apps-deployment">Chapter 4: K3S Apps Deployment</a></li>
    <li><a href="#deploying-traefik">Deploying Traefik</a>
      <ul>
        <li>
          <ul>
            <li><a href="#install-helm-package-manager-for-kubernetes">Install Helm Package Manager for Kubernetes</a></li>
            <li><a href="#create-namespace-for-traefik">Create Namespace for Traefik</a></li>
            <li><a href="#add-helm-repository-and-update">Add Helm Repository and Update</a></li>
            <li><a href="#clone-technotim-launchpad-repository">Clone TechnoTim Launchpad Repository</a></li>
            <li><a href="#configure-valuesyaml-for-traefik">Configure <code>values.yaml</code> for Traefik</a></li>
            <li><a href="#install-traefik-using-helm">Install Traefik Using Helm</a></li>
            <li><a href="#verify-deployment">Verify Deployment</a></li>
            <li><a href="#apply-middleware">Apply Middleware</a></li>
          </ul>
        </li>
        <li><a href="#deploying-traefik-dashboard">Deploying Traefik Dashboard</a>
          <ul>
            <li><a href="#install-htpasswd">Install <code>htpasswd</code></a></li>
            <li><a href="#generate-a-base64-encoded-credential">Generate a Base64-Encoded Credential</a></li>
            <li><a href="#configure-dns-resolver">Configure DNS Resolver</a></li>
            <li><a href="#apply-kubernetes-resources">Apply Kubernetes Resources</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#deploying-cert-manager">Deploying Cert-Manager</a>
      <ul>
        <li>
          <ul>
            <li><a href="#add-jetstack-helm-repository">Add Jetstack Helm Repository</a></li>
            <li><a href="#create-namespace-for-cert-manager">Create Namespace for Cert-Manager</a></li>
            <li><a href="#apply-crds-custom-resource-definitions">Apply CRDs (Custom Resource Definitions)</a></li>
            <li><a href="#install-cert-manager-using-helm">Install Cert-Manager Using Helm</a></li>
            <li><a href="#apply-cloudflare-api-secret">Apply Cloudflare API Secret</a></li>
            <li><a href="#deploy-production-certificates">Deploy Production Certificates</a></li>
            <li><a href="#verify-logs-and-challenges">Verify Logs and Challenges</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#deploying-rancher">Deploying Rancher</a>
      <ul>
        <li><a href="#add-rancher-helm-repository-and-create-namespace">Add Rancher Helm Repository and Create Namespace</a></li>
        <li><a href="#create-ingress-for-rancher">Create Ingress for Rancher</a></li>
      </ul>
    </li>
    <li><a href="#deploying-longhorn">Deploying Longhorn</a>
      <ul>
        <li><a href="#install-required-packages">Install Required Packages</a></li>
        <li><a href="#enable-iscsi">Enable iSCSI</a></li>
        <li><a href="#add-longhorn-label-on-nodes">Add Longhorn Label on Nodes</a></li>
        <li><a href="#deploy-longhorn">Deploy Longhorn</a></li>
        <li><a href="#verify-deployment-1">Verify Deployment</a></li>
        <li><a href="#print-confirmation">Print Confirmation</a></li>
      </ul>
    </li>
    <li><a href="#exposing-longhorn-with-traefik">Exposing Longhorn with Traefik</a>
      <ul>
        <li><a href="#create-middleware-configuration">Create Middleware Configuration</a></li>
        <li><a href="#setup-ingress">Setup Ingress</a></li>
      </ul>
    </li>
    <li><a href="#using-nfs-storage">Using NFS Storage</a></li>
    <li><a href="#monitoring-your-cluster">Monitoring Your Cluster</a></li>
    <li><a href="#continuous-deployment-with-argocd">Continuous Deployment with ArgoCD</a></li>
    <li><a href="#upgrading-your-cluster">Upgrading Your Cluster</a></li>
    <li><a href="#final-thoughts">Final Thoughts</a>
      <ul>
        <li><a href="#how-have-you-deployed-your-clusters">How Have You Deployed Your Clusters?</a></li>
        <li><a href="#special-thanks">Special Thanks</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#what-i-want-to-achieve">What I Want to Achieve</a></li>
    <li><a href="#how-i-will-deploy">How I Will Deploy</a></li>
    <li><a href="#lets-begin">Let’s Begin!</a></li>
    <li><a href="#chapter-1-preparing-dns-and-ip-addresses">Chapter 1: Preparing DNS and IP Addresses</a>
      <ul>
        <li><a href="#dhcp-configuration">DHCP Configuration</a></li>
        <li><a href="#my-approach">My Approach</a></li>
        <li><a href="#dns-setup">DNS Setup</a></li>
      </ul>
    </li>
    <li><a href="#chapter-2-automated-vm-deployment-on-proxmox-with-cloud-init">Chapter 2: Automated VM Deployment on Proxmox with Cloud-Init</a>
      <ul>
        <li><a href="#prerequisites">Prerequisites</a></li>
        <li><a href="#script-overview">Script Overview</a></li>
        <li><a href="#the-bash-script">The Bash Script</a></li>
        <li><a href="#verifying-your-deployment">Verifying Your Deployment</a></li>
      </ul>
    </li>
    <li><a href="#chapter-3-installing-k3s-with-ansible">Chapter 3: Installing K3s with Ansible</a>
      <ul>
        <li><a href="#prerequisites-1">Prerequisites</a></li>
        <li><a href="#pre-deployment-configuration">Pre-Deployment Configuration</a>
          <ul>
            <li><a href="#ansible_user">ansible_user:</a></li>
            <li><a href="#system_timezone">system_timezone:</a></li>
            <li><a href="#networking-calico-vs-flannel">Networking (<code>Calico</code> vs. <code>Flannel</code>):</a></li>
            <li><a href="#apiserver_endpoint">apiserver_endpoint:</a></li>
            <li><a href="#k3s_token">k3s_token:</a></li>
            <li><a href="#metal_lb_ip_range">metal_lb_ip_range:</a></li>
          </ul>
        </li>
        <li><a href="#deploy-the-cluster">Deploy the Cluster</a></li>
      </ul>
    </li>
    <li><a href="#whats-next">What’s Next?</a></li>
    <li><a href="#chapter-4-k3s-apps-deployment">Chapter 4: K3S Apps Deployment</a></li>
    <li><a href="#deploying-traefik">Deploying Traefik</a>
      <ul>
        <li>
          <ul>
            <li><a href="#install-helm-package-manager-for-kubernetes">Install Helm Package Manager for Kubernetes</a></li>
            <li><a href="#create-namespace-for-traefik">Create Namespace for Traefik</a></li>
            <li><a href="#add-helm-repository-and-update">Add Helm Repository and Update</a></li>
            <li><a href="#clone-technotim-launchpad-repository">Clone TechnoTim Launchpad Repository</a></li>
            <li><a href="#configure-valuesyaml-for-traefik">Configure <code>values.yaml</code> for Traefik</a></li>
            <li><a href="#install-traefik-using-helm">Install Traefik Using Helm</a></li>
            <li><a href="#verify-deployment">Verify Deployment</a></li>
            <li><a href="#apply-middleware">Apply Middleware</a></li>
          </ul>
        </li>
        <li><a href="#deploying-traefik-dashboard">Deploying Traefik Dashboard</a>
          <ul>
            <li><a href="#install-htpasswd">Install <code>htpasswd</code></a></li>
            <li><a href="#generate-a-base64-encoded-credential">Generate a Base64-Encoded Credential</a></li>
            <li><a href="#configure-dns-resolver">Configure DNS Resolver</a></li>
            <li><a href="#apply-kubernetes-resources">Apply Kubernetes Resources</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#deploying-cert-manager">Deploying Cert-Manager</a>
      <ul>
        <li>
          <ul>
            <li><a href="#add-jetstack-helm-repository">Add Jetstack Helm Repository</a></li>
            <li><a href="#create-namespace-for-cert-manager">Create Namespace for Cert-Manager</a></li>
            <li><a href="#apply-crds-custom-resource-definitions">Apply CRDs (Custom Resource Definitions)</a></li>
            <li><a href="#install-cert-manager-using-helm">Install Cert-Manager Using Helm</a></li>
            <li><a href="#apply-cloudflare-api-secret">Apply Cloudflare API Secret</a></li>
            <li><a href="#deploy-production-certificates">Deploy Production Certificates</a></li>
            <li><a href="#verify-logs-and-challenges">Verify Logs and Challenges</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#deploying-rancher">Deploying Rancher</a>
      <ul>
        <li><a href="#add-rancher-helm-repository-and-create-namespace">Add Rancher Helm Repository and Create Namespace</a></li>
        <li><a href="#create-ingress-for-rancher">Create Ingress for Rancher</a></li>
      </ul>
    </li>
    <li><a href="#deploying-longhorn">Deploying Longhorn</a>
      <ul>
        <li><a href="#install-required-packages">Install Required Packages</a></li>
        <li><a href="#enable-iscsi">Enable iSCSI</a></li>
        <li><a href="#add-longhorn-label-on-nodes">Add Longhorn Label on Nodes</a></li>
        <li><a href="#deploy-longhorn">Deploy Longhorn</a></li>
        <li><a href="#verify-deployment-1">Verify Deployment</a></li>
        <li><a href="#print-confirmation">Print Confirmation</a></li>
      </ul>
    </li>
    <li><a href="#exposing-longhorn-with-traefik">Exposing Longhorn with Traefik</a>
      <ul>
        <li><a href="#create-middleware-configuration">Create Middleware Configuration</a></li>
        <li><a href="#setup-ingress">Setup Ingress</a></li>
      </ul>
    </li>
    <li><a href="#using-nfs-storage">Using NFS Storage</a></li>
    <li><a href="#monitoring-your-cluster">Monitoring Your Cluster</a></li>
    <li><a href="#continuous-deployment-with-argocd">Continuous Deployment with ArgoCD</a></li>
    <li><a href="#upgrading-your-cluster">Upgrading Your Cluster</a></li>
    <li><a href="#final-thoughts">Final Thoughts</a>
      <ul>
        <li><a href="#how-have-you-deployed-your-clusters">How Have You Deployed Your Clusters?</a></li>
        <li><a href="#special-thanks">Special Thanks</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



  (function () {
    var $toc = $('#TableOfContents');
    if ($toc.length > 0) {
      var $window = $(window);

      function onScroll() {
        var currentScroll = $window.scrollTop();
        var h = $('.anchor');
        var id = "";
        h.each(function (i, e) {
          e = $(e);
          if (e.offset().top - $(window).height()/3 <= currentScroll) {
            id = decodeURIComponent(e.attr('id'));
          }
        });
        var active = $toc.find('a.active');      
        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

        active.each(function (i, e) {
           
            $(e).removeClass('active').siblings('ul').hide();
          
        });
        $toc.find('a[href="#' + id + '"]').addClass('active')
        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
          $(e).children('a').parents('ul').show();          
        });
      }

      $window.on('scroll', onScroll);
      $(document).ready(function () {
         
          $toc.find('a').parent('li').find('ul').hide();
        
        onScroll();
      });
    }
  })();


</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          <p>It’s already been a year since my first Kubernetes journey. My initial clusters—where I started learning and understanding more about Kubernetes—are now all taken down. This time, I want to build a <strong>fully functional, highly available (HA) cluster</strong>.</p>
<p>Over the past weeks, I’ve done more research in Kubernetes communities, as well as on subreddits like [kubernetes], [homelab], and [selfhosted]. I discovered that one of the best ways to deploy a cluster these days is by following guides and content from <strong>Techno Tim</strong>, so I decided to write this blog and share <strong>my own approach</strong>.</p>

  
  
  
  



<div
  
    class="flex px-4 py-3 rounded-md"
    style="background-color: #3B82F6"
  >

  <span
    
      class="ltr:pr-3 rtl:pl-3 flex items-center"
      style="color: #1d3557"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      style="color: #F3F4F6"
    ><strong>Tip:</strong> If you’re new to K3s, subreddits like <a href="https://www.reddit.com/r/kubernetes/" target="_blank">r/kubernetes</a> and <a href="https://www.reddit.com/r/homelab/" target="_blank">r/homelab</a> can be great resources to learn from fellow enthusiasts.</span>
</div>

<hr>


<h2 class="relative group">What I Want to Achieve 
    <div id="what-i-want-to-achieve" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#what-i-want-to-achieve" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<ul>
<li>A fully organized HA cluster on my hardware, so if any of my machines go down, the cluster remains functional. Specifically:
<ul>
<li><strong>1 x DELL R720</strong> → <code>k3s-master-1</code> and <code>k3s-worker-1</code></li>
<li><strong>1 x DELL Optiplex Micro 3050</strong> → <code>k3s-master-2</code> and <code>k3s-worker-2</code></li>
<li><strong>1 x DELL Optiplex Micro 3050</strong> → <code>k3s-master-3</code> and <code>k3s-worker-3</code></li>
</ul>
</li>
</ul>
<hr>


<h2 class="relative group">How I Will Deploy 
    <div id="how-i-will-deploy" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#how-i-will-deploy" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>I will create <strong>six virtual machines (VMs)</strong> on a <strong>Proxmox cluster</strong>:</p>
<ul>
<li><strong>3 x Ubuntu 22.04 Master Nodes</strong></li>
<li><strong>3 x Ubuntu 22.04 Worker Nodes</strong></li>
</ul>
<p>The goal is to run <strong>K3s</strong> on these VMs to set up a solid Kubernetes environment with redundancy.</p>
<hr>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2989869646477878"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
style="display:block"
data-ad-format="fluid"
data-ad-layout-key="-gw-3+1f-3d+2z"
data-ad-client="ca-pub-2989869646477878"
data-ad-slot="3410757899"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h2 class="relative group">Let’s Begin! 
    <div id="lets-begin" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#lets-begin" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>In the upcoming sections, I’ll detail each step, from setting up Proxmox VMs to installing and configuring K3s, managing networking, storage, and beyond.</p>


<h2 class="relative group">Chapter 1: Preparing DNS and IP Addresses 
    <div id="chapter-1-preparing-dns-and-ip-addresses" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#chapter-1-preparing-dns-and-ip-addresses" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>When setting up a Kubernetes cluster, <strong>DNS and IP management</strong> are crucial. Below is how I handle DHCP, static IP assignments, and DNS entries in my homelab environment.</p>
<hr>


<h3 class="relative group">DHCP Configuration 
    <div id="dhcp-configuration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#dhcp-configuration" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>There are two possible scenarios for assigning IP addresses to your VMs:</p>
<ol>
<li>
<p><strong>Use IP addresses outside of your DHCP range</strong><br>
This method is often preferred, as your machines will keep their manually configured network settings even if your DHCP server goes down.</p>
</li>
<li>
<p><strong>DHCP Static Mappings</strong><br>
You can map <code>MAC -&gt; IP</code> in your network services to allocate IP addresses to VMs based on their MAC addresses.</p>
</li>
</ol>
<p><strong>Tip:</strong> If you choose the second scenario, make sure you document your static leases carefully. Proper documentation avoids conflicts and confusion later.</p>
<hr>


<h3 class="relative group">My Approach 
    <div id="my-approach" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#my-approach" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>I chose the <strong>first scenario</strong>, where I use IPs outside the DHCP range. This ensures my network remains stable if the DHCP service is unavailable.</p>
<ul>
<li><strong>IP Range</strong>: <code>10.57.57.30/24</code> → <code>10.57.57.35/24</code> for my VMs</li>
</ul>
<hr>


<h3 class="relative group">DNS Setup 
    <div id="dns-setup" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#dns-setup" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>I also set up a DNS entry in my <strong>Unbound</strong> service on pfSense to easily manage and access my machines. For instance, you can create an <code>A</code> record or similar DNS record type pointing to your VM’s IP address. Below is a simple example:</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="Pasted%20Graphic.png" alt="unbound_pfsense" />
      
    </figure>
</p>
<hr>


<h2 class="relative group">Chapter 2: Automated VM Deployment on Proxmox with Cloud-Init 
    <div id="chapter-2-automated-vm-deployment-on-proxmox-with-cloud-init" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#chapter-2-automated-vm-deployment-on-proxmox-with-cloud-init" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>To streamline the next steps, I’ve created a <strong>bash script</strong> that automates crucial parts of the process, including:</p>
<ul>
<li>Creating a <strong>Cloud-Init</strong> template</li>
<li>Deploying multiple <strong>VMs</strong> with static IP addresses</li>
<li>Destroying the VMs if needed</li>
</ul>
<p>If you prefer an even more automated approach using tools like <strong>Packer</strong> or <strong>Terraform</strong>, I suggest checking out this related post: <a href="https://merox.dev/blog/homelab-as-code/" target="_blank">Homelab as Code</a> and adapting it to your specific scenario. However, for this blog, I’ll demonstrate a simpler, more direct approach using the script below.</p>

  
  
  
  



<div
  
    class="flex px-4 py-3 rounded-md"
    style="background-color: #ffae00"
  >

  <span
    
      class="ltr:pr-3 rtl:pl-3 flex items-center"
      style="color: #1d3557"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      style="color: #F3F4F6"
    ><strong>Warning</strong><br>
This script can create or destroy VMs. Use it carefully and always keep backups of critical data.</span>
</div>

<hr>


<h3 class="relative group">Prerequisites 
    <div id="prerequisites" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#prerequisites" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ul>
<li>Make sure you have <strong>Proxmox</strong> up and running.</li>
<li>You’ll need to place your <strong>SSH public key</strong> (e.g., <code>/root/.ssh/id_rsa.pub</code>) on the Proxmox server before running the script.</li>
</ul>
<hr>


<h3 class="relative group">Script Overview 
    <div id="script-overview" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#script-overview" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><strong>Option 1: Create Cloud-Init Template</strong></p>
<ul>
<li>Downloads the Ubuntu Cloud image (currently Ubuntu 24.04, code-named “noble”)</li>
<li>Creates a VM based on the Cloud-Init image</li>
<li>Converts it into a template</li>
</ul>
<p><strong>Option 2: Deploy VMs</strong></p>
<ul>
<li>Clones the <strong>Cloud-Init</strong> template to create the desired number of VMs</li>
<li>Configures IP addressing, gateway, DNS, search domain, SSH key, etc.</li>
<li>Adjusts CPU, RAM, and disk size to fit your needs</li>
</ul>
<p><strong>Option 3: Destroy VMs</strong></p>
<ul>
<li>Stops and removes VMs created by this script</li>
</ul>
<p>During the VM creation process, you’ll be prompted to enter the <strong>VM name</strong> for each instance (e.g., <code>k3s-master-1</code>, <code>k3s-master-2</code>, etc.).</p>

  
  
  
  



<div
  
    class="flex px-4 py-3 rounded-md"
    style="background-color: #3B82F6"
  >

  <span
    
      class="ltr:pr-3 rtl:pl-3 flex items-center"
      style="color: #1d3557"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      style="color: #F3F4F6"
    ><strong>Tip</strong><br>
To fully automate naming, you could edit the script to increment VM names automatically. However, prompting ensures you can organize VMs with custom naming.</span>
</div>

<hr>


<h3 class="relative group">The Bash Script 
    <div id="the-bash-script" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-bash-script" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Below is the full script. Feel free to customize it based on your storage, networking, and naming preferences.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">  1</span><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="c1"># Function to get user input with a default value</span>
</span></span><span class="line"><span class="ln">  4</span><span class="cl">get_input<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="ln">  5</span><span class="cl">    <span class="nb">local</span> <span class="nv">prompt</span><span class="o">=</span><span class="nv">$1</span>
</span></span><span class="line"><span class="ln">  6</span><span class="cl">    <span class="nb">local</span> <span class="nv">default</span><span class="o">=</span><span class="nv">$2</span>
</span></span><span class="line"><span class="ln">  7</span><span class="cl">    <span class="nb">local</span> input
</span></span><span class="line"><span class="ln">  8</span><span class="cl">    <span class="nb">read</span> -p <span class="s2">&#34;</span><span class="nv">$prompt</span><span class="s2"> [</span><span class="nv">$default</span><span class="s2">]: &#34;</span> input
</span></span><span class="line"><span class="ln">  9</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">input</span><span class="k">:-</span><span class="nv">$default</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln"> 10</span><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="ln"> 11</span><span class="cl">
</span></span><span class="line"><span class="ln"> 12</span><span class="cl"><span class="c1"># Ask the user whether they want to create a template, deploy or destroy VMs</span>
</span></span><span class="line"><span class="ln"> 13</span><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Select an option:&#34;</span>
</span></span><span class="line"><span class="ln"> 14</span><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;1) Create Cloud-Init Template&#34;</span>
</span></span><span class="line"><span class="ln"> 15</span><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;2) Deploy VMs&#34;</span>
</span></span><span class="line"><span class="ln"> 16</span><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;3) Destroy VMs&#34;</span>
</span></span><span class="line"><span class="ln"> 17</span><span class="cl"><span class="nb">read</span> -p <span class="s2">&#34;Enter your choice (1, 2, or 3): &#34;</span> ACTION
</span></span><span class="line"><span class="ln"> 18</span><span class="cl">
</span></span><span class="line"><span class="ln"> 19</span><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$ACTION</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;1&#34;</span> <span class="o">&amp;&amp;</span> <span class="s2">&#34;</span><span class="nv">$ACTION</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;2&#34;</span> <span class="o">&amp;&amp;</span> <span class="s2">&#34;</span><span class="nv">$ACTION</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;3&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln"> 20</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;❌ Invalid choice. Please run the script again and select 1, 2, or 3.&#34;</span>
</span></span><span class="line"><span class="ln"> 21</span><span class="cl">    <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="ln"> 22</span><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="ln"> 23</span><span class="cl">
</span></span><span class="line"><span class="ln"> 24</span><span class="cl"><span class="c1"># === OPTION 1: CREATE CLOUD-INIT TEMPLATE ===</span>
</span></span><span class="line"><span class="ln"> 25</span><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$ACTION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;1&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln"> 26</span><span class="cl">    <span class="nv">TEMPLATE_ID</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the template VM ID&#34;</span> <span class="s2">&#34;300&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">    <span class="nv">STORAGE</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the storage name&#34;</span> <span class="s2">&#34;local&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">    <span class="nv">TEMPLATE_NAME</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the template name&#34;</span> <span class="s2">&#34;ubuntu-cloud&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">    <span class="nv">IMG_URL</span><span class="o">=</span><span class="s2">&#34;https://cloud-images.ubuntu.com/noble/current/noble-server-cloudimg-amd64.img&#34;</span>
</span></span><span class="line"><span class="ln"> 30</span><span class="cl">    <span class="nv">IMG_FILE</span><span class="o">=</span><span class="s2">&#34;/root/noble-server-cloudimg-amd64.img&#34;</span>
</span></span><span class="line"><span class="ln"> 31</span><span class="cl">
</span></span><span class="line"><span class="ln"> 32</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;📥 Downloading Ubuntu Cloud image...&#34;</span>
</span></span><span class="line"><span class="ln"> 33</span><span class="cl">    <span class="nb">cd</span> /root
</span></span><span class="line"><span class="ln"> 34</span><span class="cl">    wget -O <span class="nv">$IMG_FILE</span> <span class="nv">$IMG_URL</span> <span class="o">||</span> <span class="o">{</span> <span class="nb">echo</span> <span class="s2">&#34;❌ Failed to download the image&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="ln"> 35</span><span class="cl">
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;🖥️ Creating VM </span><span class="nv">$TEMPLATE_ID</span><span class="s2">...&#34;</span>
</span></span><span class="line"><span class="ln"> 37</span><span class="cl">    qm create <span class="nv">$TEMPLATE_ID</span> --memory <span class="m">2048</span> --cores <span class="m">2</span> --name <span class="nv">$TEMPLATE_NAME</span> --net0 virtio,bridge<span class="o">=</span>vmbr0
</span></span><span class="line"><span class="ln"> 38</span><span class="cl">
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;💾 Importing disk to storage (</span><span class="nv">$STORAGE</span><span class="s2">)...&#34;</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">    qm disk import <span class="nv">$TEMPLATE_ID</span> <span class="nv">$IMG_FILE</span> <span class="nv">$STORAGE</span> <span class="o">||</span> <span class="o">{</span> <span class="nb">echo</span> <span class="s2">&#34;❌ Failed to import disk&#34;</span><span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="ln"> 41</span><span class="cl">
</span></span><span class="line"><span class="ln"> 42</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;🔗 Attaching disk...&#34;</span>
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">    qm <span class="nb">set</span> <span class="nv">$TEMPLATE_ID</span> --scsihw virtio-scsi-pci --scsi0 <span class="nv">$STORAGE</span>:vm-<span class="nv">$TEMPLATE_ID</span>-disk-0
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;☁️ Adding Cloud-Init drive...&#34;</span>
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">    qm <span class="nb">set</span> <span class="nv">$TEMPLATE_ID</span> --ide2 <span class="nv">$STORAGE</span>:cloudinit
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;🛠️ Configuring boot settings...&#34;</span>
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">    qm <span class="nb">set</span> <span class="nv">$TEMPLATE_ID</span> --boot c --bootdisk scsi0
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;🖧 Adding serial console...&#34;</span>
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">    qm <span class="nb">set</span> <span class="nv">$TEMPLATE_ID</span> --serial0 socket --vga serial0
</span></span><span class="line"><span class="ln"> 53</span><span class="cl">
</span></span><span class="line"><span class="ln"> 54</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;📌 Converting VM to template...&#34;</span>
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">    qm template <span class="nv">$TEMPLATE_ID</span>
</span></span><span class="line"><span class="ln"> 56</span><span class="cl">
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;✅ Cloud-Init Template created successfully!&#34;</span>
</span></span><span class="line"><span class="ln"> 58</span><span class="cl">    <span class="nb">exit</span> <span class="m">0</span>
</span></span><span class="line"><span class="ln"> 59</span><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">
</span></span><span class="line"><span class="ln"> 61</span><span class="cl"><span class="c1"># === OPTION 2: DEPLOY VMs ===</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$ACTION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;2&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln"> 63</span><span class="cl">    <span class="nv">TEMPLATE_ID</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the template VM ID&#34;</span> <span class="s2">&#34;300&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 64</span><span class="cl">    <span class="nv">START_ID</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the starting VM ID&#34;</span> <span class="s2">&#34;301&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 65</span><span class="cl">    <span class="nv">NUM_VMS</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the number of VMs to deploy&#34;</span> <span class="s2">&#34;6&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl">    <span class="nv">STORAGE</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the storage name&#34;</span> <span class="s2">&#34;dataz2&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">    <span class="nv">IP_PREFIX</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the IP prefix (e.g., 10.57.57.)&#34;</span> <span class="s2">&#34;10.57.57.&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">    <span class="nv">IP_START</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the starting IP last octet&#34;</span> <span class="s2">&#34;30&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">    <span class="nv">GATEWAY</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the gateway IP&#34;</span> <span class="s2">&#34;10.57.57.1&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">    <span class="nv">DNS_SERVERS</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the DNS servers (space-separated)&#34;</span> <span class="s2">&#34;8.8.8.8 1.1.1.1&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">    <span class="nv">DOMAIN_SEARCH</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the search domain&#34;</span> <span class="s2">&#34;merox.dev&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">    <span class="nv">DISK_SIZE</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the disk size (e.g., 100G)&#34;</span> <span class="s2">&#34;100G&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">    <span class="nv">RAM_SIZE</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the RAM size in MB&#34;</span> <span class="s2">&#34;16384&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">    <span class="nv">CPU_CORES</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the number of CPU cores&#34;</span> <span class="s2">&#34;4&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">    <span class="nv">CPU_SOCKETS</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the number of CPU sockets&#34;</span> <span class="s2">&#34;4&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">    <span class="nv">SSH_KEY_PATH</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the SSH public key file path&#34;</span> <span class="s2">&#34;/root/.ssh/id_rsa.pub&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">    <span class="k">if</span> <span class="o">[[</span> ! -f <span class="s2">&#34;</span><span class="nv">$SSH_KEY_PATH</span><span class="s2">&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln"> 79</span><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;❌ Error: SSH key file not found at </span><span class="nv">$SSH_KEY_PATH</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">        <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">    <span class="k">for</span> i in <span class="k">$(</span>seq <span class="m">0</span> <span class="k">$((</span>NUM_VMS <span class="o">-</span> <span class="m">1</span><span class="k">)))</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">        <span class="nv">VM_ID</span><span class="o">=</span><span class="k">$((</span>START_ID <span class="o">+</span> i<span class="k">))</span>
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">        <span class="nv">IP</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$IP_PREFIX</span><span class="k">$((</span>IP_START <span class="o">+</span> i<span class="k">))</span><span class="s2">/24&#34;</span>
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">        <span class="nv">VM_NAME</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the name for VM </span><span class="nv">$VM_ID</span><span class="s2">&#34;</span> <span class="s2">&#34;ubuntu-vm-</span><span class="k">$((</span>i+1<span class="k">))</span><span class="s2">&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;🔹 Creating VM: </span><span class="nv">$VM_ID</span><span class="s2"> (Name: </span><span class="nv">$VM_NAME</span><span class="s2">, IP: </span><span class="nv">$IP</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">
</span></span><span class="line"><span class="ln"> 90</span><span class="cl">        <span class="k">if</span> qm status <span class="nv">$VM_ID</span> <span class="p">&amp;</span>&gt;/dev/null<span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln"> 91</span><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;⚠️ VM </span><span class="nv">$VM_ID</span><span class="s2"> already exists, removing...&#34;</span>
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">            qm stop <span class="nv">$VM_ID</span> <span class="p">&amp;</span>&gt;/dev/null
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">            qm destroy <span class="nv">$VM_ID</span>
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">
</span></span><span class="line"><span class="ln"> 96</span><span class="cl">        <span class="k">if</span> ! qm clone <span class="nv">$TEMPLATE_ID</span> <span class="nv">$VM_ID</span> --full --name <span class="nv">$VM_NAME</span> --storage <span class="nv">$STORAGE</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;❌ Failed to clone VM </span><span class="nv">$VM_ID</span><span class="s2">, skipping...&#34;</span>
</span></span><span class="line"><span class="ln"> 98</span><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="ln">100</span><span class="cl">
</span></span><span class="line"><span class="ln">101</span><span class="cl">        qm <span class="nb">set</span> <span class="nv">$VM_ID</span> --memory <span class="nv">$RAM_SIZE</span> <span class="se">\
</span></span></span><span class="line"><span class="ln">102</span><span class="cl"><span class="se"></span>                      --cores <span class="nv">$CPU_CORES</span> <span class="se">\
</span></span></span><span class="line"><span class="ln">103</span><span class="cl"><span class="se"></span>                      --sockets <span class="nv">$CPU_SOCKETS</span> <span class="se">\
</span></span></span><span class="line"><span class="ln">104</span><span class="cl"><span class="se"></span>                      --cpu host <span class="se">\
</span></span></span><span class="line"><span class="ln">105</span><span class="cl"><span class="se"></span>                      --serial0 socket <span class="se">\
</span></span></span><span class="line"><span class="ln">106</span><span class="cl"><span class="se"></span>                      --vga serial0 <span class="se">\
</span></span></span><span class="line"><span class="ln">107</span><span class="cl"><span class="se"></span>                      --ipconfig0 <span class="nv">ip</span><span class="o">=</span><span class="nv">$IP</span>,gw<span class="o">=</span><span class="nv">$GATEWAY</span> <span class="se">\
</span></span></span><span class="line"><span class="ln">108</span><span class="cl"><span class="se"></span>                      --nameserver <span class="s2">&#34;</span><span class="nv">$DNS_SERVERS</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="ln">109</span><span class="cl"><span class="se"></span>                      --searchdomain <span class="s2">&#34;</span><span class="nv">$DOMAIN_SEARCH</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="ln">110</span><span class="cl"><span class="se"></span>                      --sshkey <span class="s2">&#34;</span><span class="nv">$SSH_KEY_PATH</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln">111</span><span class="cl">
</span></span><span class="line"><span class="ln">112</span><span class="cl">        qm <span class="nb">set</span> <span class="nv">$VM_ID</span> --delete ide2 <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="ln">113</span><span class="cl">        qm <span class="nb">set</span> <span class="nv">$VM_ID</span> --ide2 <span class="nv">$STORAGE</span>:cloudinit,media<span class="o">=</span>cdrom
</span></span><span class="line"><span class="ln">114</span><span class="cl">        qm cloudinit update <span class="nv">$VM_ID</span>
</span></span><span class="line"><span class="ln">115</span><span class="cl">
</span></span><span class="line"><span class="ln">116</span><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;🔄 Resizing disk to </span><span class="nv">$DISK_SIZE</span><span class="s2">...&#34;</span>
</span></span><span class="line"><span class="ln">117</span><span class="cl">        qm resize <span class="nv">$VM_ID</span> scsi0 +<span class="nv">$DISK_SIZE</span>
</span></span><span class="line"><span class="ln">118</span><span class="cl">
</span></span><span class="line"><span class="ln">119</span><span class="cl">        qm start <span class="nv">$VM_ID</span>
</span></span><span class="line"><span class="ln">120</span><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;✅ VM </span><span class="nv">$VM_ID</span><span class="s2"> (</span><span class="nv">$VM_NAME</span><span class="s2">) created and started!&#34;</span>
</span></span><span class="line"><span class="ln">121</span><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="ln">122</span><span class="cl">    <span class="nb">exit</span> <span class="m">0</span>
</span></span><span class="line"><span class="ln">123</span><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="ln">124</span><span class="cl">
</span></span><span class="line"><span class="ln">125</span><span class="cl"><span class="c1"># === OPTION 3: DESTROY VMs ===</span>
</span></span><span class="line"><span class="ln">126</span><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$ACTION</span><span class="s2">&#34;</span> <span class="o">==</span> <span class="s2">&#34;3&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln">127</span><span class="cl">    <span class="nv">START_ID</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the starting VM ID to delete&#34;</span> <span class="s2">&#34;301&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl">    <span class="nv">NUM_VMS</span><span class="o">=</span><span class="k">$(</span>get_input <span class="s2">&#34;Enter the number of VMs to delete&#34;</span> <span class="s2">&#34;6&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln">129</span><span class="cl">
</span></span><span class="line"><span class="ln">130</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;⚠️ Destroying VMs from </span><span class="nv">$START_ID</span><span class="s2"> to </span><span class="k">$((</span>START_ID <span class="o">+</span> NUM_VMS <span class="o">-</span> <span class="m">1</span><span class="k">))</span><span class="s2">...&#34;</span>
</span></span><span class="line"><span class="ln">131</span><span class="cl">    <span class="k">for</span> i in <span class="k">$(</span>seq <span class="m">0</span> <span class="k">$((</span>NUM_VMS <span class="o">-</span> <span class="m">1</span><span class="k">)))</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="ln">132</span><span class="cl">        <span class="nv">VM_ID</span><span class="o">=</span><span class="k">$((</span>START_ID <span class="o">+</span> i<span class="k">))</span>
</span></span><span class="line"><span class="ln">133</span><span class="cl">
</span></span><span class="line"><span class="ln">134</span><span class="cl">        <span class="k">if</span> qm status <span class="nv">$VM_ID</span> <span class="p">&amp;</span>&gt;/dev/null<span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln">135</span><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;🛑 Stopping and destroying VM </span><span class="nv">$VM_ID</span><span class="s2">...&#34;</span>
</span></span><span class="line"><span class="ln">136</span><span class="cl">            qm stop <span class="nv">$VM_ID</span> <span class="p">&amp;</span>&gt;/dev/null
</span></span><span class="line"><span class="ln">137</span><span class="cl">            qm destroy <span class="nv">$VM_ID</span>
</span></span><span class="line"><span class="ln">138</span><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="ln">139</span><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;ℹ️ VM </span><span class="nv">$VM_ID</span><span class="s2"> does not exist. Skipping...&#34;</span>
</span></span><span class="line"><span class="ln">140</span><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="ln">141</span><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="ln">142</span><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;✅ Specified VMs have been destroyed.&#34;</span>
</span></span><span class="line"><span class="ln">143</span><span class="cl">    <span class="nb">exit</span> <span class="m">0</span>
</span></span><span class="line"><span class="ln">144</span><span class="cl"><span class="k">fi</span></span></span></code></pre></div>


<h3 class="relative group">Verifying Your Deployment 
    <div id="verifying-your-deployment" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#verifying-your-deployment" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>After running the script under Option 2, you should see your new VMs listed in the Proxmox web interface. You can now log in via SSH from the machine that holds the corresponding private key</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh ubuntu@k3s-master-01
</span></span></code></pre></div><p><strong>Note</strong>: Adjust the hostname or IP as configured during the script prompts.</p>


<h2 class="relative group">Chapter 3: Installing K3s with Ansible 
    <div id="chapter-3-installing-k3s-with-ansible" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#chapter-3-installing-k3s-with-ansible" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>This chapter will guide you through setting up <strong>K3s</strong> using <strong>Ansible</strong> on your Proxmox-based VMs. Ansible helps automate the process across multiple nodes, making the deployment faster and more reliable.</p>
<hr>


<h3 class="relative group">Prerequisites 
    <div id="prerequisites-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#prerequisites-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ol>
<li>
<p><strong>Ensure Ansible is installed on your management machine</strong> (Debian/Ubuntu or macOS):</p>
<ul>
<li><strong>Debian/Ubuntu</strong>:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt update <span class="o">&amp;&amp;</span> sudo apt install -y ansible
</span></span></code></pre></div></li>
<li><strong>macOS</strong>:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew install ansible
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Clone the k3s-ansible repository</strong></p>
<p>We will use Techno Tim’s <a href="https://github.com/techno-tim/k3s-ansible" target="_blank">k3s-ansible repository</a>, but in this guide, we’ll use a forked version:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/mer0x/k3s-ansible
</span></span></code></pre></div></li>
</ol>
<hr>


<h3 class="relative group">Pre-Deployment Configuration 
    <div id="pre-deployment-configuration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#pre-deployment-configuration" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ol>
<li>
<p><strong>Set up the Ansible environment</strong>:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">   <span class="nb">cd</span> k3s-ansible
</span></span><span class="line"><span class="ln">2</span><span class="cl">   cp ansible.example.cfg ansible.cfg
</span></span><span class="line"><span class="ln">3</span><span class="cl">   ansible-galaxy install -r ./collections/requirements.yml
</span></span><span class="line"><span class="ln">4</span><span class="cl">   cp -R inventory/sample inventory/my-cluster</span></span></code></pre></div></p>
</li>
<li>
<p><strong>Edit <code>inventory/my-cluster/hosts.ini</code></strong></p>
<p>Modify this file to match your cluster’s IP addresses. Example:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="ln"> 1</span><span class="cl">   <span class="k">[master]</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">   <span class="na">10.57.57.30</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">   <span class="na">10.57.57.31</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">   <span class="na">10.57.57.32</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">   <span class="k">[node]</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">   <span class="na">10.57.57.33</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">   <span class="na">10.57.57.34</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">   <span class="na">10.57.57.35</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">   <span class="k">[k3s_cluster:children]</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">   <span class="na">master</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">   <span class="na">node</span></span></span></code></pre></div></p>
</li>
<li>
<p><strong>Edit <code>inventory/my-cluster/group_vars/all.yml</code></strong></p>
<p>Some critical fields to modify:</p>


<h4 class="relative group">ansible_user: 
    <div id="ansible_user" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#ansible_user" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<ul>
<li>Default VM user is <code>ubuntu</code> with sudo privileges.</li>
</ul>


<h4 class="relative group">system_timezone: 
    <div id="system_timezone" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#system_timezone" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<ul>
<li>Set to your local timezone (e.g., <code>Europe/Bucharest</code>).</li>
</ul>


<h4 class="relative group">Networking (<code>Calico</code> vs. <code>Flannel</code>): 
    <div id="networking-calico-vs-flannel" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#networking-calico-vs-flannel" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<ul>
<li>Comment out <code>#flannel_iface: eth0</code> and use <code>calico_iface: &quot;eth0&quot;</code> for better network policies.</li>
<li>Flannel is the simpler alternative if you prefer an easier setup.</li>
</ul>


<h4 class="relative group">apiserver_endpoint: 
    <div id="apiserver_endpoint" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#apiserver_endpoint" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<ul>
<li>10.57.57.100</li>
<li>Ensure this is an unused IP in your local network.</li>
<li>It serves as the VIP (Virtual IP) for the k3s control plane.</li>
</ul>


<h4 class="relative group">k3s_token: 
    <div id="k3s_token" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#k3s_token" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<ul>
<li>Use any alphanumeric string.</li>
</ul>


<h4 class="relative group">metal_lb_ip_range: 
    <div id="metal_lb_ip_range" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#metal_lb_ip_range" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<ul>
<li>10.57.57.80-10.57.57.90
<ul>
<li>The IP belongs to your local network (LAN)</li>
<li>It&rsquo;s not already in use by other network services</li>
<li>It&rsquo;s outside your DHCP pool range to avoid conflicts</li>
<li>This setup enables exposing K3s container services to your network, similar to how Docker ports are exposed to their host IP.</li>
</ul>
</li>
</ul>
</li>
</ol>

  
  
  
  



<div
  
    class="flex px-4 py-3 rounded-md"
    style="background-color: #3B82F6"
  >

  <span
    
      class="ltr:pr-3 rtl:pl-3 flex items-center"
      style="color: #1d3557"
    >

    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"/></svg>

  </span>


  </span>

  <span
    
      style="color: #F3F4F6"
    >Before running the next command, ensure SSH key authentication is set up between your management machine and all deployed VMs.</span>
</div>

<hr>


<h3 class="relative group">Deploy the Cluster 
    <div id="deploy-the-cluster" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#deploy-the-cluster" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Run the following command to deploy the cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ansible-playbook ./site.yml -i ./inventory/my-cluster/hosts.ini
</span></span></code></pre></div><p>Once the playbook execution completes, you can verify the cluster’s status:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># Copy the kubeconfig file from the first master node</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">scp ubuntu@10.57.57.30:~/.kube/config .
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"># Move it to the correct location</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">mkdir -p ~/.kube
</span></span><span class="line"><span class="ln">6</span><span class="cl">mv config ~/.kube/
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="c1"># Check if the cluster nodes are properly registered</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl">kubectl get nodes</span></span></code></pre></div>
<p>If the setup was successful, <code>kubectl get nodes</code> should display the cluster’s nodes and their statuses.</p>
<hr>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2989869646477878"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
style="display:block"
data-ad-format="fluid"
data-ad-layout-key="-gw-3+1f-3d+2z"
data-ad-client="ca-pub-2989869646477878"
data-ad-slot="3410757899"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h2 class="relative group">What’s Next? 
    <div id="whats-next" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#whats-next" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>With K3s successfully deployed, the next steps involve setting up additional tools such as <strong>Rancher</strong>, <strong>Traefik</strong>, and <strong>Longhorn</strong> for cluster management, ingress control, and persistent storage.</p>


<h2 class="relative group">Chapter 4: K3S Apps Deployment 
    <div id="chapter-4-k3s-apps-deployment" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#chapter-4-k3s-apps-deployment" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h2 class="relative group">Deploying Traefik 
    <div id="deploying-traefik" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#deploying-traefik" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h4 class="relative group">Install Helm Package Manager for Kubernetes 
    <div id="install-helm-package-manager-for-kubernetes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#install-helm-package-manager-for-kubernetes" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="ln">1</span><span class="cl"><span class="na">curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="na">chmod 700 get_helm.sh</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="na">./get_helm.sh</span></span></span></code></pre></div>


<h4 class="relative group">Create Namespace for Traefik 
    <div id="create-namespace-for-traefik" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#create-namespace-for-traefik" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create namespace traefik
</span></span></code></pre></div>

<h4 class="relative group">Add Helm Repository and Update 
    <div id="add-helm-repository-and-update" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#add-helm-repository-and-update" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">helm repo add traefik https://helm.traefik.io/traefik
</span></span><span class="line"><span class="cl">helm repo update
</span></span></code></pre></div>

<h4 class="relative group">Clone TechnoTim Launchpad Repository 
    <div id="clone-technotim-launchpad-repository" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#clone-technotim-launchpad-repository" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/techno-tim/launchpad
</span></span></code></pre></div>

<h4 class="relative group">Configure <code>values.yaml</code> for Traefik 
    <div id="configure-valuesyaml-for-traefik" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#configure-valuesyaml-for-traefik" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>Open the <code>launchpad/kubernetes/traefik-cert-manager/</code> directory and check <code>values.yaml</code>. Most configurations are already set; you only need to specify the IP for the LoadBalancer service. Choose an IP from the MetalLB range defined in your setup <a href="#metal_lb_ip_range">here</a>.</p>


<h4 class="relative group">Install Traefik Using Helm 
    <div id="install-traefik-using-helm" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#install-traefik-using-helm" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">helm install --namespace<span class="o">=</span>traefik traefik traefik/traefik --values<span class="o">=</span>values.yaml
</span></span></code></pre></div>

<h4 class="relative group">Verify Deployment 
    <div id="verify-deployment" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#verify-deployment" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl get svc --all-namespaces -o wide
</span></span></code></pre></div><p>Expected output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="ln">1</span><span class="cl"><span class="na">NAMESPACE          NAME                              TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                                    AGE     SELECTOR</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="na">calico-system      calico-typha                      ClusterIP      10.43.80.131    &lt;none&gt;        5473/TCP                                   2d20h   k8s-app</span><span class="o">=</span><span class="s">calico-typha</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="na">traefik            traefik                           LoadBalancer   10.43.185.67    10.57.57.80   80:32195/TCP,443:31598/TCP,443:31598/UDP   53s     app.kubernetes.io/instance</span><span class="o">=</span><span class="s">traefik,app.kubernetes.io/name=traefik</span></span></span></code></pre></div>


<h4 class="relative group">Apply Middleware 
    <div id="apply-middleware" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#apply-middleware" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -f default-headers.yaml
</span></span><span class="line"><span class="cl">kubectl get middleware
</span></span></code></pre></div><p>Expected output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">NAME              AGE
</span></span><span class="line"><span class="cl">default-headers   4s
</span></span></code></pre></div>

<h3 class="relative group">Deploying Traefik Dashboard 
    <div id="deploying-traefik-dashboard" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#deploying-traefik-dashboard" aria-label="Anchor">#</a>
    </span>        
    
</h3>


<h4 class="relative group">Install <code>htpasswd</code> 
    <div id="install-htpasswd" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#install-htpasswd" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt-get update
</span></span><span class="line"><span class="cl">sudo apt-get install apache2-utils
</span></span></code></pre></div>

<h4 class="relative group">Generate a Base64-Encoded Credential 
    <div id="generate-a-base64-encoded-credential" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#generate-a-base64-encoded-credential" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">htpasswd -nb merox password <span class="p">|</span> openssl base64
</span></span></code></pre></div><ul>
<li>Copy the generated password hash and replace <code>abc123==</code> with it in <code>dashboard/secret-dashboard.yaml</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Secret</span><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">traefik-dashboard-auth</span><span class="w">
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">traefik</span><span class="w">
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="w"></span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">Opaque</span><span class="w">
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="w"></span><span class="nt">data</span><span class="p">:</span><span class="w">
</span></span></span><span class="line hl"><span class="ln">9</span><span class="cl"><span class="w">  </span><span class="nt">users</span><span class="p">:</span><span class="w"> </span><span class="l">abc123==</span><span class="w">
</span></span></span></code></pre></div><p>Apply secret</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -f secret-dashboard.yaml
</span></span></code></pre></div>

<h4 class="relative group">Configure DNS Resolver 
    <div id="configure-dns-resolver" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#configure-dns-resolver" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>Ensure that your DNS server points to the MetalLB IP specified in <code>values.yaml</code> <a href="#configure-valuesyaml-for-traefik">here</a>.</p>
<p>Example entry for <strong>pfSense DNS Resolver</strong>:</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="Pasted%20Graphic-1.png" alt="dns" />
      
    </figure>
</p>
<p><code>dashboard/ingress.yaml</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">routes:
</span></span><span class="line"><span class="cl">  - match: Host<span class="o">(</span><span class="sb">`</span>traefik.k3s.your.domain<span class="sb">`</span><span class="o">)</span>
</span></span></code></pre></div>

<h4 class="relative group">Apply Kubernetes Resources 
    <div id="apply-kubernetes-resources" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#apply-kubernetes-resources" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p><em>from traefik/dashboard folder</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="line"><span class="ln">1</span><span class="cl"><span class="na">kubectl apply -f secret-dashboard.yaml</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="na">kubectl get secrets --namespace traefik</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="na">kubectl apply -f middleware.yaml</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="na">kubectl apply -f ingress.yaml</span></span></span></code></pre></div>
<p>At this point, you should be able to access the DNS entry you created. However, it will use a self-signed SSL certificate generated by Traefik. In the next steps, we will configure Let&rsquo;s Encrypt certificates using Cloudflare as the provider.</p>
<hr>


<h2 class="relative group">Deploying Cert-Manager 
    <div id="deploying-cert-manager" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#deploying-cert-manager" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p><em>traefik-cert-manager/cert-manager</em> folder</p>


<h4 class="relative group">Add Jetstack Helm Repository 
    <div id="add-jetstack-helm-repository" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#add-jetstack-helm-repository" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">helm repo add jetstack https://charts.jetstack.io
</span></span><span class="line"><span class="cl">helm repo update
</span></span></code></pre></div>

<h4 class="relative group">Create Namespace for Cert-Manager 
    <div id="create-namespace-for-cert-manager" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#create-namespace-for-cert-manager" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create namespace cert-manager
</span></span></code></pre></div>

<h4 class="relative group">Apply CRDs (Custom Resource Definitions) 
    <div id="apply-crds-custom-resource-definitions" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#apply-crds-custom-resource-definitions" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p><strong>Note:</strong> Ensure you use the latest <a href="https://cert-manager.io/docs/releases/" target="_blank">version</a> of Cert-Manager.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.17.0/cert-manager.crds.yaml
</span></span></code></pre></div>

<h4 class="relative group">Install Cert-Manager Using Helm 
    <div id="install-cert-manager-using-helm" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#install-cert-manager-using-helm" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">helm install cert-manager jetstack/cert-manager --namespace cert-manager --values<span class="o">=</span>values.yaml --version v1.17.0
</span></span></code></pre></div>

<h4 class="relative group">Apply Cloudflare API Secret 
    <div id="apply-cloudflare-api-secret" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#apply-cloudflare-api-secret" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>Make sure you generate the correct API token if using Cloudflare (use an <a href="https://cert-manager.io/docs/configuration/acme/dns01/cloudflare/#api-tokens" target="_blank">API Token</a>, not a global key).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -f issuers/secret-cf-token.yaml
</span></span></code></pre></div>

<h4 class="relative group">Deploy Production Certificates 
    <div id="deploy-production-certificates" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#deploy-production-certificates" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<ul>
<li>
<p>Fields to be edited before:</p>
<p>issuers/letsencrypt-production.yaml</p>
<ul>
<li><code>email</code>, <code>dnsZones</code></li>
</ul>
<p>certificates/production/your-domain-com.yaml</p>
<ul>
<li><code>name</code>, <code>secretName</code>, <code>commonName</code>, <code>dnsNames</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -f values.yaml
</span></span><span class="line"><span class="cl">kubectl apply -f issuers/letsencrypt-production.yaml
</span></span><span class="line"><span class="cl">kubectl apply -f certificates/production/your-domain-com.yaml
</span></span></code></pre></div>

<h4 class="relative group">Verify Logs and Challenges 
    <div id="verify-logs-and-challenges" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#verify-logs-and-challenges" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl logs -n cert-manager -f cert-manager-<span class="o">(</span>your-instance-name<span class="o">)</span>
</span></span><span class="line"><span class="cl">kubectl get challenges
</span></span></code></pre></div><hr>
<p>With these steps completed, your K3s cluster now runs Traefik as an ingress controller, supports HTTPS with Let&rsquo;s Encrypt, and manages certificates automatically. This setup ensures secure traffic routing and efficient load balancing for your Kubernetes applications.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /archived/blog/k3s-cluster-in-2025/image_hu_641eb561ebdc2799.png 330w,
        /archived/blog/k3s-cluster-in-2025/image_hu_da2bdac3979eace1.png 660w,
        /archived/blog/k3s-cluster-in-2025/image_hu_d5c06ff6a9cf7e0f.png 1024w,
        /archived/blog/k3s-cluster-in-2025/image_hu_1523ea0c68b9a24c.png 2x"
        data-zoom-src="/archived/blog/k3s-cluster-in-2025/image_hu_1523ea0c68b9a24c.png"
        src="/archived/blog/k3s-cluster-in-2025/image_hu_da2bdac3979eace1.png"
        alt="traefik-k3s"
      />
      
    </figure>

<em>✨ Nailed it!</em></p>


<h2 class="relative group">Deploying Rancher 
    <div id="deploying-rancher" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#deploying-rancher" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">Add Rancher Helm Repository and Create Namespace 
    <div id="add-rancher-helm-repository-and-create-namespace" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#add-rancher-helm-repository-and-create-namespace" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">helm repo add rancher-latest https://releases.rancher.com/server-charts/stable
</span></span><span class="line"><span class="cl">kubectl create namespace cattle-system
</span></span></code></pre></div><p>Since Traefik is already deployed, Rancher will utilize it for ingress. Deploy Rancher with Helm:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">helm install rancher rancher-stable/rancher <span class="se">\
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="se"></span>  --namespace cattle-system <span class="se">\
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="se"></span>  --set <span class="nv">hostname</span><span class="o">=</span>rancher.k3s.your.domain <span class="se">\
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="se"></span>  --set <span class="nv">tls</span><span class="o">=</span>external <span class="se">\
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="se"></span>  --set <span class="nv">replicas</span><span class="o">=</span><span class="m">3</span></span></span></code></pre></div>


<h3 class="relative group">Create Ingress for Rancher 
    <div id="create-ingress-for-rancher" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#create-ingress-for-rancher" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Create an <code>ingress.yml</code> file with the following configuration:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">traefik.io/v1alpha1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">IngressRoute</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">rancher</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">cattle-system</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">  </span><span class="nt">entryPoints</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">    </span>- <span class="l">websecure</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">  </span><span class="nt">routes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">    </span>- <span class="nt">match</span><span class="p">:</span><span class="w"> </span><span class="l">Host(`rancher.k3s.your.domain`)</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">      </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Rule</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">      </span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">rancher</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">          </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">443</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">      </span><span class="nt">middlewares</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">default-headers</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">  </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">    </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l">k3s-your-domain-tls</span></span></span></code></pre></div>
<p>Apply the ingress configuration:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -f ingress.yml
</span></span></code></pre></div><p>Now, you should be able to manage your cluster from <a href="https://rancher.k3s.your.domain" target="_blank">https://rancher.k3s.your.domain</a>.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /archived/blog/k3s-cluster-in-2025/image-2_hu_ae40748eaf339582.png 330w,
        /archived/blog/k3s-cluster-in-2025/image-2_hu_b500be57cbbf8f3.png 660w,
        /archived/blog/k3s-cluster-in-2025/image-2_hu_230b1c5c52ee960b.png 1024w,
        /archived/blog/k3s-cluster-in-2025/image-2_hu_c28820a9296357c6.png 2x"
        data-zoom-src="/archived/blog/k3s-cluster-in-2025/image-2_hu_c28820a9296357c6.png"
        src="/archived/blog/k3s-cluster-in-2025/image-2_hu_b500be57cbbf8f3.png"
        alt="rancher"
      />
      
    </figure>
</p>


<h2 class="relative group">Deploying Longhorn 
    <div id="deploying-longhorn" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#deploying-longhorn" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>If you want to use cloud-ready drive shared storage, follow these steps:</p>


<h3 class="relative group">Install Required Packages 
    <div id="install-required-packages" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#install-required-packages" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><em>only on the VMs you want to deploy longhorn</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt update <span class="o">&amp;&amp;</span> sudo apt install -y open-iscsi nfs-common
</span></span></code></pre></div>

<h3 class="relative group">Enable iSCSI 
    <div id="enable-iscsi" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#enable-iscsi" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> iscsid
</span></span><span class="line"><span class="cl">sudo systemctl start iscsid
</span></span></code></pre></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2989869646477878"
     crossorigin="anonymous"></script>
<p><ins class="adsbygoogle"
style="display:block"
data-ad-format="fluid"
data-ad-layout-key="-gw-3+1f-3d+2z"
data-ad-client="ca-pub-2989869646477878"
data-ad-slot="3410757899"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h3 class="relative group">Add Longhorn Label on Nodes 
    <div id="add-longhorn-label-on-nodes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#add-longhorn-label-on-nodes" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>A minimum of three nodes are required for High Availability. In this setup, we will use three worker nodes:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">kubectl label node k3s-worker-1 storage.longhorn.io/node<span class="o">=</span><span class="nb">true</span> 
</span></span><span class="line"><span class="ln">2</span><span class="cl">kubectl label node k3s-worker-2 storage.longhorn.io/node<span class="o">=</span><span class="nb">true</span> 
</span></span><span class="line"><span class="ln">3</span><span class="cl">kubectl label node k3s-worker-3 storage.longhorn.io/node<span class="o">=</span>true</span></span></code></pre></div></p>


<h3 class="relative group">Deploy Longhorn 
    <div id="deploy-longhorn" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#deploy-longhorn" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><em>modified to use <code>storage.longhorn.io/node=true</code> label</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -f https://raw.githubusercontent.com/mer0x/merox.docs/refs/heads/master/K3S/cluster-deployment/longhorn.yaml
</span></span></code></pre></div>

<h3 class="relative group">Verify Deployment 
    <div id="verify-deployment-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#verify-deployment-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl get pods --namespace longhorn-system --watch
</span></span></code></pre></div>

<h3 class="relative group">Print Confirmation 
    <div id="print-confirmation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#print-confirmation" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl get nodes
</span></span><span class="line"><span class="cl">kubectl get svc -n longhorn-system
</span></span></code></pre></div>

<h2 class="relative group">Exposing Longhorn with Traefik 
    <div id="exposing-longhorn-with-traefik" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#exposing-longhorn-with-traefik" aria-label="Anchor">#</a>
    </span>        
    
</h2>


<h3 class="relative group">Create Middleware Configuration 
    <div id="create-middleware-configuration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#create-middleware-configuration" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Create a <code>middleware.yml</code> file:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">1</span><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">traefik.io/v1alpha1</span><span class="w">
</span></span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Middleware</span><span class="w">
</span></span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">longhorn-headers</span><span class="w">
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">longhorn-system</span><span class="w">
</span></span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="w">  </span><span class="nt">headers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="w">    </span><span class="nt">customRequestHeaders</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">9</span><span class="cl"><span class="w">      </span><span class="nt">X-Forwarded-Proto</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https&#34;</span></span></span></code></pre></div></p>


<h3 class="relative group">Setup Ingress 
    <div id="setup-ingress" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#setup-ingress" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Create an <code>ingress.yml</code> file:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">networking.k8s.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Ingress</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">longhorn-ingress</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">longhorn-system</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">    </span><span class="nt">traefik.ingress.kubernetes.io/router.entrypoints</span><span class="p">:</span><span class="w"> </span><span class="l">websecure</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">    </span><span class="nt">traefik.ingress.kubernetes.io/router.tls</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">    </span><span class="nt">traefik.ingress.kubernetes.io/router.middlewares</span><span class="p">:</span><span class="w"> </span><span class="l">longhorn-system-longhorn-headers@kubernetescrd</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">  </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">  </span>- <span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">storage.k3s.your.domain</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">    </span><span class="nt">http</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">      </span><span class="nt">paths</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">      </span>- <span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l">Prefix</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">        </span><span class="nt">backend</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">          </span><span class="nt">service</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">longhorn-frontend</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">  </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w">  </span>- <span class="nt">hosts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">    </span>- <span class="l">storage.k3s.your.domain</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">    </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l">k3s-your-domain-tls</span></span></span></code></pre></div></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        srcset="
        /archived/blog/k3s-cluster-in-2025/image-1_hu_c502f8042019303d.png 330w,
        /archived/blog/k3s-cluster-in-2025/image-1_hu_b706bae3457f9e1b.png 660w,
        /archived/blog/k3s-cluster-in-2025/image-1_hu_6f4f631340116d5e.png 1024w,
        /archived/blog/k3s-cluster-in-2025/image-1_hu_c8af48f57bc27fe8.png 2x"
        data-zoom-src="/archived/blog/k3s-cluster-in-2025/image-1_hu_c8af48f57bc27fe8.png"
        src="/archived/blog/k3s-cluster-in-2025/image-1_hu_b706bae3457f9e1b.png"
        alt="longhorn"
      />
      
    </figure>
</p>


<h2 class="relative group">Using NFS Storage 
    <div id="using-nfs-storage" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#using-nfs-storage" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>If you want to use NFS storage in your cluster, follow this guide:
<a href="https://docs.merox.dev/operations/containerization/k3s/manifests/nfs-share/?h=nfs" target="_blank">Merox Docs - NFS Storage Guide</a></p>


<h2 class="relative group">Monitoring Your Cluster 
    <div id="monitoring-your-cluster" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#monitoring-your-cluster" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>A great monitoring tool for your cluster is <a href="https://docs.merox.dev/operations/containerization/k3s/manifests/netdata/" target="_blank">Netdata</a>.</p>
<p>You can also try deploying Prometheus and Grafana from Rancher. However, if you don’t fine-tune the setup, you might notice a high resource usage due to the large number of queries processed by Prometheus.</p>


<h2 class="relative group">Continuous Deployment with ArgoCD 
    <div id="continuous-deployment-with-argocd" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#continuous-deployment-with-argocd" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>ArgoCD is an excellent tool for continuous deployment. You can find more details <a href="https://docs.merox.dev/operations/containerization/k3s/manifests/argocd" target="_blank">here</a>.</p>


<h2 class="relative group">Upgrading Your Cluster 
    <div id="upgrading-your-cluster" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#upgrading-your-cluster" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>If you need to upgrade your cluster, I put some notes here: <a href="https://docs.merox.dev/operations/containerization/k3s/upgrade/" target="_blank">How to Upgrade K3s</a>.</p>


<h2 class="relative group">Final Thoughts 
    <div id="final-thoughts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#final-thoughts" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>When I first deployed a K3s/RKE2 cluster (about a year ago), I struggled to find a single source of documentation that covered everything needed for at least a homelab, if not even for production use. Unfortunately, I couldn&rsquo;t find anything comprehensive, so I decided to write this article to consolidate all the necessary information in one place.</p>
<p>If this guide helped you and you’d like to see more information added, please leave a comment, and I will do my best to update this post.</p>


<h3 class="relative group">How Have You Deployed Your Clusters? 
    <div id="how-have-you-deployed-your-clusters" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#how-have-you-deployed-your-clusters" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Let me know in the comments!</p>


<h3 class="relative group">Special Thanks 
    <div id="special-thanks" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#special-thanks" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<ul>
<li><a href="https://technotim.live/" target="_blank">TechnoTim</a></li>
<li><a href="https://github.com/JamesTurland/" target="_blank">James Turland</a></li>
</ul>

          
          
          
        </div>
        
        

        
        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/&amp;title=How%20to%20Set%20Up%20a%20K3S%20Cluster%20in%202025"
      title="Share on LinkedIn"
      aria-label="Share on LinkedIn"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://twitter.com/intent/tweet/?url=https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/&amp;text=How%20to%20Set%20Up%20a%20K3S%20Cluster%20in%202025"
      title="Tweet on Twitter"
      aria-label="Tweet on Twitter"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://api.whatsapp.com/send?text=https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/&amp;resubmit=true&amp;title=How%20to%20Set%20Up%20a%20K3S%20Cluster%20in%202025"
      title="Share via WhatsApp"
      aria-label="Share via WhatsApp"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://t.me/share/url?url=https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/&amp;resubmit=true&amp;title=How%20to%20Set%20Up%20a%20K3S%20Cluster%20in%202025"
      title="Share via Telegram"
      aria-label="Share via Telegram"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://pinterest.com/pin/create/bookmarklet/?url=https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/&amp;description=How%20to%20Set%20Up%20a%20K3S%20Cluster%20in%202025"
      title="Pin on Pinterest"
      aria-label="Pin on Pinterest"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://reddit.com/submit/?url=https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/&amp;resubmit=true&amp;title=How%20to%20Set%20Up%20a%20K3S%20Cluster%20in%202025"
      title="Submit to Reddit"
      aria-label="Submit to Reddit"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.facebook.com/sharer/sharer.php?u=https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/&amp;quote=How%20to%20Set%20Up%20a%20K3S%20Cluster%20in%202025"
      title="Share on Facebook"
      aria-label="Share on Facebook"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="mailto:?body=https://mer0x.github.io/archived/blog/k3s-cluster-in-2025/&amp;subject=How%20to%20Set%20Up%20a%20K3S%20Cluster%20in%202025"
      title="Send via email"
      aria-label="Send via email"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


    </a>
      
    
  </section>


        


<h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
<section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
  
  

  <a href="/archived/blog/kubernetes-media-server/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/archived/blog/kubernetes-media-server/featured-k8smedia_hu_8ee9b2e5121245d3.webp);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/archived/blog/kubernetes-media-server/">Deploying a Kubernetes-Based Media Server</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-03-06T00:00:00&#43;00:00">6 March 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">9 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/categories/devops/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    DevOps
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/categories/cloud--self-hosting/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cloud &amp; Self-Hosting
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/kubernetes/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/self-hosting/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Self-Hosting
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/media-server/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Media-Server
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          For a long time, I&rsquo;ve been on the hunt for a comprehensive and well-crafted tutorial to deploy a media server on my Kubernetes cluster.
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/archived/blog/homelab-as-code/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/archived/blog/homelab-as-code/featured-homelabascode_hu_4c64e85576b0acde.webp);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/archived/blog/homelab-as-code/">Homelab as Code: Packer + Terraform + Ansible</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-12-17T00:00:00&#43;00:00">17 December 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">7 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/categories/infrastructure/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Infrastructure
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/categories/devops/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    DevOps
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/automation/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Automation
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/terraform/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Terraform
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/ansible/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Ansible
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/homelab/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Homelab
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          Explore the evolution of a homelab, from its humble beginnings to a fully automated infrastructure. Learn how to implement cutting-edge tools and techniques for IT experimentation and skill-building.
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/archived/blog/run-ai-at-home/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/archived/blog/run-ai-at-home/featured-ai_hu_d627dd3f04e346d4.webp);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/archived/blog/run-ai-at-home/">How to Set Up Your Own AI at Home</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  







  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-08-16T00:00:00&#43;00:00">16 August 2024</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">7 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/categories/cloud--self-hosting/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cloud &amp; Self-Hosting
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/ai/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Ai
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/self-hosting/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Self-Hosting
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/archived/tags/server/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Server
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          In this article, I will go over how I set these tools up on my server as well as their configurations. The difficulties that were there , the solutions I found and useful tips&hellip;
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
</section>

  
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_blog\/k3s-cluster-in-2025\/index.md"
        var oid_likes = "likes_blog\/k3s-cluster-in-2025\/index.md"
      </script>
      
      
      <script type="text/javascript" src="/archived/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/archived/blog/homelab-as-code/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Homelab as Code: Packer + Terraform + Ansible</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-12-17T00:00:00&#43;00:00">17 December 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/archived/blog/3-2-1-backup-strategy/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Disaster Recovery Guide: My Approach to Safeguarding Critical Data</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-03-01T00:00:00&#43;00:00">1 March 2025</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
    
    <div class="pt-3">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="pt-3">
        <div id="disqus_thread"></div>
<script>
    

    

    (function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://merox.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      </div>
    </div>
    
    
  </footer>
</article>
  <!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        #modern-banner {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background: #050224;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            max-width: 90%;
            width: 400px;
            transition: all 0.3s ease;
            font-family: Arial, sans-serif;
        }
        #modern-banner .banner-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        #modern-banner .banner-title {
            color: #ffffff;
            font-size: 18px;
            font-weight: bold;
        }
        #modern-banner .banner-content {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            height: 250px;
        }
        #modern-banner iframe {
            display: block;
            width: 100%;
            height: 100%;
            border: none;
        }
        #modern-banner .close-btn {
            background: none;
            color: #fff;
            border: none;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s ease;
            opacity: 0.7;
            padding: 0;
            width: 30px;
            height: 30px;
        }
        #modern-banner .close-btn:hover {
            transform: scale(1.1);
            opacity: 1;
        }
        @media (max-width: 600px) {
            #modern-banner {
                width: calc(100% - 40px);
                max-width: none;
            }
        }
    </style>
</head>
<body>
    

    <div id="modern-banner" style="display: none;">
        <div class="banner-header">
            <div class="banner-title">Subscribe to the newsletter</div>
            <button class="close-btn" onclick="closeBanner()">×</button>
        </div>
        <div class="banner-content">
            <iframe src="https://b3fbfc70.sibforms.com/serve/MUIFAD81DdedXBbGTpVMN2Bn_wL36h3eSDK_P206yKJBORJirF7ovERtfbKbNilHbEDPJnwOhGdnOy1rAPgsG0wTSWoNMuF1BSzE0VNdvGm3qSPbgBIKYm54hmvLwBHCKNfGFhdlCjcXmh4yulv0_CRp_X3TtYfjgtjTUZEsvCwHWvkcKWAtArfkmHKMghdpuX_aEd-Y2GpkL7EQ" frameborder="0" scrolling="no" allowfullscreen></iframe>
        </div>
    </div>

    <script>
        function setCookie(name, value, days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + (value || "")  + expires + "; path=/";
        }

        function getCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for(var i=0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0)==' ') c = c.substring(1,c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
            }
            return null;
        }

        function closeBanner() {
            document.getElementById('modern-banner').style.display = 'none';
            setCookie('bannerClosed', 'true', 1); 
        }

        window.onload = function() {
            setTimeout(function() {
                if (!getCookie('bannerClosed')) {
                    document.getElementById('modern-banner').style.display = 'block';
                }
            }, 10000); 
        }
    </script>
</body>
</html>


      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/archived/tags/"
            title="">
            
            Tags
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/archived/categories/"
            title="">
            
            Categories
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/archived/privacy/"
            title="">
            
            Privacy
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/archived/terms-and-conditions/"
            title="">
            
            Terms
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="https://tools.merox.dev"
            title="">
            
            Tools
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400"> 
      <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>
      &copy;
      2025
      Robert Melcher
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a> <br> Designed by <a href='https://www.freepik.com' target='_blank' rel='noopener noreferrer'>Freepik</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/archived/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://mer0x.github.io/archived/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

 <script id="cookieyes" type="text/javascript" src="https://cdn-cookieyes.com/client_data/c55f9db6ae89f7b5791cc5da/script.js"></script> 
</html>
